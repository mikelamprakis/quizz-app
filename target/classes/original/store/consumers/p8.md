## Question 14

Which actions will trigger a partition rebalance for a consumer group? (Select 3)

* A. Add the broker to the cluster
* B. Remove the broker from the cluster
* C. Add a new consumer to the group
* D. Increase partitions of the topic
* E. A consumer in the group shuts down

<details><summary>Response:</summary>

**Answer:** C, D, E

**Explanation:**
Rebalances occur when consumers join/leave the group or partitions change. Adding/removing brokers does not cause consumer group rebalances.

</details>

---

## Question 15

```java
while (true) {
    ConsumerRecords<String, String> records = consumer.poll(100);
    try {
        consumer.commitSync();
    } catch (CommitFailedException e) {
        log.error("commit failed", e);
    }
    for (ConsumerRecord<String, String> record : records) {
        System.out.printf("topic = %s, partition = %s, offset = %d, key = %s, value = %s\n",
            record.topic(), record.partition(), record.offset(), record.key(), record.value());
    }
}
```

What delivery guarantee does this offer?

* A. At-most once
* B. Exactly once
* C. At-least once

<details><summary>Response:</summary>

**Answer:** A

**Explanation:**
Offsets are committed **before** processing records. If the consumer crashes after committing but before processing, messages will be lost → at-most once delivery.

</details>

---

## Question 16

A producer uses `acks=1` and sends a message to the leader. When will a consumer see this message?

* A. When the High Watermark has advanced
* B. Right away
* C. Never — the produce request will fail

<details><summary>Response:</summary>

**Answer:** A

**Explanation:**
Consumers read only up to the High Watermark, which advances after the message is replicated to all in-sync replicas. `acks=1` means only leader ack, so the High Watermark advances later.

</details>
