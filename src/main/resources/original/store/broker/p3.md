## Question 11

Consider a Kafka topic with the following configuration:

* `cleanup.policy` = "compact,delete"
* `min.cleanable.dirty.ratio` = 0.5
* `delete.retention.ms` = 86400000 (1 day)
* `segment.ms` = 43200000 (12 hours)

Which of the following statements correctly describes the behavior of log compaction and deletion for this topic?

* A. Log compaction and deletion are mutually exclusive; only one policy can be active at any time.
* B. Log compaction will occur once 50% of the segment data is marked as dirty, and logs older than 1 day will be deleted.
* C. Deleted records are removed immediately from the log; `delete.retention.ms` specifies the retention time for all records.
* D. `segment.ms` dictates the maximum lifespan of any record in the log, after which it is eligible for compaction or deletion.

<details><summary>Response:</summary> 

**Answer:** B

**Explanation:**
Kafka supports both compaction and deletion on a topic when `cleanup.policy = compact,delete`.

* Compaction triggers when 50% of the segment is "dirty" (`min.cleanable.dirty.ratio = 0.5`).
* `delete.retention.ms` holds tombstones (delete markers) for 1 day before they're purged.
* `segment.ms` simply determines how often Kafka rolls new segments; it doesnâ€™t control record retention.

</details>

---

## Question 12

In a Kafka cluster, the Controller is a critical component for managing cluster state. Which of the following statements accurately describe the role and election of the Controller? (Select two)

* A. Elected by broker majority
* B. Elected by Zookeeper ensemble
* C. Responsible for partition leader election
* D. Manages consumer group offsets
* E. Automatically assigns replicas to brokers based on load

<details><summary>Response:</summary> 

**Answer:** B and C

**Explanation:**

* **B. Elected by Zookeeper ensemble**: Kafka uses Zookeeper to manage cluster metadata, including electing the Controller. Brokers create ephemeral nodes, and Zookeeper selects the Controller from live brokers.

* **C. Responsible for partition leader election**: The Controller manages which broker is the leader for each partition, especially during failures.

* **A** is incorrect because election is handled by Zookeeper, not by a broker majority.

* **D** is incorrect since offset management is handled by Kafka brokers and stored in the `__consumer_offsets` topic.

* **E** is incorrect; replica assignment happens at topic creation or via manual tools, not automatically by the Controller.

Note: Kafka's newer KRaft mode (post-Zookeeper) changes this behavior slightly but Zookeeper is still common in many setups.

</details>

---

## Question 13

In the context of Kafka's distributed architecture, broker elections are vital for cluster health and stability. Consider the following advanced scenarios where Kafka's internal mechanisms must decide on leadership roles:

* A. The Zookeeper ensemble elects the new Controller based on ephemeral node creation sequence.
* B. The new partition leader is elected based on the ISR list order, favoring replicas with the most recent updates.
* C. Brokers in the main cluster segment with access to Zookeeper retain their roles, while isolated brokers step down until connectivity is restored.
* D. A broker majority within the isolated segment elects a new temporary Controller until the network partition is resolved.
* E. The election of a new partition leader among replicas with identical network latency is determined by a random selection process.

<details><summary>Response:</summary> 

**Answer:** A, B, and C

**Explanation:**

* **A**: Correct. Zookeeper uses ephemeral nodes to elect a new Controller. The broker that registers first (based on sequence) becomes the new Controller.

* **B**: Correct. Partition leader election is based on the ISR list. The Controller selects the first available in-sync replica as the new leader.

* **C**: Correct. Only brokers with access to Zookeeper retain leadership roles. Isolated brokers lose leadership until they reconnect.

* **D** is incorrect because Kafka does not perform elections within isolated segments.

* **E** is incorrect because election is deterministic based on ISR, not random or latency-based.

</details>

---
