## Question 50

Can a producer guarantee the order of messages within a partition when sending messages with different keys?

* A. Yes, messages within a partition are always guaranteed to be in the same order as they were sent by the producer
* B. No, messages with different keys can be written to the same partition in a different order than they were sent
* C. It depends on the configuration of the producer
* D. It depends on the configuration of the topic

<details><summary>Response:</summary>

**Answer:** B

**Explanation:**
Kafka guarantees ordering *within a partition* for messages with the *same key*. When different keys are used, messages may be routed to different partitions (based on key hash), and even if routed to the same partition, ordering is not guaranteed. Partition assignment and write timing can lead to interleaving of messages.

</details>

---

## Question 51

What happens when a producer tries to send a message to a partition whose leader replica is not in-sync?

* A. The producer receives a `NotLeaderOrFollowerException` and retries sending the message
* B. The producer waits until the leader replica becomes in-sync before sending the message
* C. The message is automatically routed to another in-sync replica
* D. The producer receives a `LeaderNotAvailableException` and the message is discarded

<details><summary>Response:</summary>

**Answer:** A

**Explanation:**
If the producer tries to send to a broker that is not the leader for a partition, it receives a `NotLeaderOrFollowerException`. The producer then refreshes its metadata and retries. Kafka does not automatically reroute to another replicaâ€”only the partition leader can accept writes.

</details>

---

## Question 52

In a topic with a replication factor of 3 and `min.insync.replicas` set to 2, what happens when a producer sends a message with `acks=all` and two replicas are not in-sync?

* A. The producer receives an acknowledgment and the message is successfully written
* B. The producer receives a `NotEnoughReplicasException` and the message is not written
* C. The producer waits indefinitely until at least two replicas become in-sync
* D. The message is written to the leader replica and the producer receives an acknowledgment

<details><summary>Response:</summary>

**Answer:** B

**Explanation:**
With `acks=all`, Kafka requires acknowledgment from all *in-sync* replicas. If only one replica (the leader) is in-sync and `min.insync.replicas=2`, the message will not be acknowledged, and a `NotEnoughReplicasException` is returned. The producer will not wait indefinitely, and the write is considered failed.

</details>




